<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Food Delivery</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #f4f6fb;
}

header {
  padding: 16px;
  font-size: 22px;
  font-weight: 700;
}

.grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 14px;
  padding: 16px;
}

.card {
  background: #fff;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 10px 24px rgba(0,0,0,.12);
  display: flex;
  flex-direction: column;
}

.card img {
  width: 100%;
  height: 130px;
  object-fit: cover;
}

.card .info {
  padding: 12px;
  flex: 1;
}

.card .name {
  font-weight: 600;
  margin-bottom: 4px;
}

.card .price {
  color: #555;
  font-size: 14px;
  margin-bottom: 10px;
}

.card button {
  width: 100%;
  border: none;
  background: linear-gradient(135deg, #4f46e5, #6c63ff);
  color: #fff;
  padding: 10px;
  border-radius: 12px;
  font-size: 14px;
}

.cart-btn {
  position: fixed;
  bottom: 16px;
  right: 16px;
  background: #111;
  color: #fff;
  padding: 14px 18px;
  border-radius: 999px;
  font-weight: 600;
  z-index: 9999;
}

.panel {
  position: fixed;
  inset: 0;
  background: #f4f6fb;
  padding: 16px;
  overflow-y: auto;
  z-index: 10000;
}

.hidden { display: none; }

.primary-btn {
  width: 100%;
  padding: 14px;
  border: none;
  border-radius: 14px;
  background: linear-gradient(135deg, #4f46e5, #6c63ff);
  color: #fff;
  font-size: 16px;
  margin-top: 12px;
}

.secondary-btn {
  width: 100%;
  padding: 12px;
  border-radius: 14px;
  border: 1px solid #ccc;
  background: #fff;
  margin-top: 8px;
}

.item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 10px;
}

input, select {
  width: 100%;
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 10px;
  border: 1px solid #ccc;
}
</style>
</head>

<body>

<header>üçî –ú–µ–Ω—é</header>

<div id="menu" class="grid"></div>

<div class="cart-btn" onclick="openCart()">
  üõí –ö–æ—Ä–∑–∏–Ω–∞ (<span id="count">0</span>)
</div>

<div id="cart" class="panel hidden"></div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();
tg.expand();

const menu = document.getElementById("menu");
const cartDiv = document.getElementById("cart");

const foods = [
 {id:1,name:"–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",price:450,img:"https://avatars.mds.yandex.net/i?id=f2e936a65ad15cd289abab0c03c9144540793d54-5481525-images-thumbs&n=13"},
 {id:2,name:"–ü–∏—Ü—Ü–∞ –ü–µ–ø–ø–µ—Ä–æ–Ω–∏",price:520,img:"https://avatars.mds.yandex.net/i?id=7510b4effb790779ad6b3265c75d1c7b35471084-3986751-images-thumbs&n=13"},
 {id:3,name:"–ë—É—Ä–≥–µ—Ä —Å –≥–æ–≤—è–¥–∏–Ω–æ–π",price:390,img:"https://avatars.mds.yandex.net/i?id=c9bbef1504a8d0943fecab07d8e57f0a55f40e00-5257529-images-thumbs&n=13"},
 {id:4,name:"–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å —Ñ—Ä–∏",price:180,img:"https://avatars.mds.yandex.net/i?id=619ea05f2d006710198e7654da95f477da422ad3-4097709-images-thumbs&n=13"},
 {id:5,name:"–°—É—à–∏-—Å–µ—Ç –ú–∏–Ω–∏",price:890,img:"https://avatars.mds.yandex.net/i?id=317733859dd66a7b9d642cbf51b82fc8a74d81e9-4285597-images-thumbs&n=13"},
 {id:6,name:"–†–æ–ª–ª –ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏—è",price:420,img:"https://avatars.mds.yandex.net/i?id=07da68db9d07477d83c2361a6fc7523cea0fb313-4987773-images-thumbs&n=13"},
 {id:7,name:"–°–∞–ª–∞—Ç –¶–µ–∑–∞—Ä—å",price:360,img:"https://avatars.mds.yandex.net/i?id=d5d2672c9ec79214f57d5d7a889f5e8ad6d3562b-5875984-images-thumbs&n=13"},
 {id:8,name:"–ü–∞—Å—Ç–∞ —Å –∫—É—Ä–∏—Ü–µ–π",price:410,img:"https://avatars.mds.yandex.net/i?id=33ecf9434287c2d99114658524cd29b25e6386df-4027955-images-thumbs&n=13"},
 {id:9,name:"–ú–æ—Ä—Å —è–≥–æ–¥–Ω—ã–π",price:120,img:"https://avatars.mds.yandex.net/i?id=802f4b2a1808a2a84aeb9436dd5d8e313aa5a942-5231845-images-thumbs&n=13"},
 {id:10,name:"–ö–æ–ª–∞",price:150,img:"https://avatars.mds.yandex.net/i?id=f8b6d79ad3231eee5ba5b430f44584b18ef64a6d-16971848-images-thumbs&n=13"}
];

let cart = JSON.parse(localStorage.getItem("cart") || "[]");

function save() {
  localStorage.setItem("cart", JSON.stringify(cart));
  update();
}

function update() {
  document.getElementById("count").innerText = cart.length;
}

foods.forEach(f => {
  menu.innerHTML += `
    <div class="card">
      <img src="${f.img}">
      <div class="info">
        <div class="name">${f.name}</div>
        <div class="price">${f.price} ‚ÇΩ</div>
        <button onclick='add(${JSON.stringify(f)})'>‚ûï –í –∫–æ—Ä–∑–∏–Ω—É</button>
      </div>
    </div>`;
});

function add(f) {
  cart.push(f);
  save();
}

function openCart() {
  let html = "<h2>üõí –ö–æ—Ä–∑–∏–Ω–∞</h2>";
  let total = 0;

  cart.forEach(i => {
    total += i.price;
    html += `<div class="item">${i.name}<span>${i.price} ‚ÇΩ</span></div>`;
  });

  html += `
    <b>–ò—Ç–æ–≥–æ: ${total} ‚ÇΩ</b>
    <button class="primary-btn" onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
    <button class="secondary-btn" onclick="closeCart()">–ù–∞–∑–∞–¥</button>
  `;

  cartDiv.innerHTML = html;
  cartDiv.classList.remove("hidden");
}

function closeCart() {
  cartDiv.classList.add("hidden");
}

function checkout() {
  cartDiv.innerHTML = `
    <h2>üì¶ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h2>
    <input id="name" placeholder="–ò–º—è">
    <input id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
    <input id="street" placeholder="–£–ª–∏—Ü–∞">
    <input id="house" placeholder="–î–æ–º">
    <select id="pay">
      <option>–ù–∞–ª–∏—á–Ω—ã–µ</option>
      <option>–ö–∞—Ä—Ç–æ–π</option>
    </select>
    <button class="primary-btn" onclick="send()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
    <button class="secondary-btn" onclick="closeCart()">–ù–∞–∑–∞–¥</button>
  `;
}

function send() {
  const total = cart.reduce((sum, item) => sum + item.price, 0);

  const payload = {
    items: cart,
    total: total,
    name: document.getElementById("name").value,
    phone: document.getElementById("phone").value,
    address: document.getElementById("street").value + ", " +
             document.getElementById("house").value,
    payment: document.getElementById("pay").value
  };

  Telegram.WebApp.sendData(JSON.stringify(payload));
  Telegram.WebApp.close();
}


update();
</script>

</body>
</html>
