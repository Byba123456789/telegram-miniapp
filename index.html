<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Food Delivery</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body{margin:0;font-family:system-ui,sans-serif;background:#f4f6fb}
header{padding:16px;font-size:22px;font-weight:700;display:flex;align-items:center;gap:12px}
.hamburger{font-size:26px;cursor:pointer;user-select:none}

.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;padding:16px}
.card{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 10px 24px rgba(0,0,0,.12);display:flex;flex-direction:column}
.card img{width:100%;height:130px;object-fit:cover}
.card .info{padding:12px;flex:1}
.card .name{font-weight:700;margin-bottom:4px}
.card .price{color:#555;font-size:14px;margin-bottom:10px}
.card button{width:100%;border:none;background:linear-gradient(135deg,#4f46e5,#6c63ff);color:#fff;padding:10px;border-radius:12px;font-size:14px}

.cart-btn{position:fixed;bottom:16px;right:16px;background:#111;color:#fff;padding:10px 14px;border-radius:999px;font-weight:700;z-index:6;font-size:14px}
.cart-btn.small{padding:8px 12px;font-size:13px}

.panel{position:fixed;inset:0;background:#f4f6fb;padding:16px;overflow-y:auto;z-index:10}
.hidden{display:none}

.primary-btn{width:100%;padding:14px;border:none;border-radius:14px;background:linear-gradient(135deg,#4f46e5,#6c63ff);color:#fff;font-size:16px;margin-top:12px}
.secondary-btn{width:100%;padding:12px;border-radius:14px;border:1px solid #ccc;background:#fff;margin-top:8px}

.item{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;gap:10px}
.item span.remove{cursor:pointer}

input,select,textarea{width:100%;padding:12px;margin-bottom:10px;border-radius:10px;border:1px solid #ccc;box-sizing:border-box}

.sidebarOverlay{position:fixed;inset:0;background:rgba(0,0,0,.25);z-index:19}
.sidebar{position:fixed;top:0;left:0;width:260px;height:100%;background:#fff;box-shadow:2px 0 12px rgba(0,0,0,.18);padding:16px;z-index:20;transform:translateX(-110%);transition:transform .2s ease}
.sidebar.open{transform:translateX(0)}
.sidebar h3{margin:0 0 12px}
.sidebar .sbtn{width:100%;padding:12px;border-radius:12px;border:1px solid #e6e6e6;background:#f7f7f7;margin-bottom:10px;font-weight:700;cursor:pointer}

.badge{display:inline-block;padding:6px 10px;border-radius:999px;background:#eef2ff;color:#3730a3;font-weight:800;font-size:12px}

.stars{display:flex;gap:6px;margin:8px 0 12px}
.star{font-size:26px;cursor:pointer;user-select:none;filter:drop-shadow(0 1px 0 rgba(0,0,0,.1))}
.star.off{opacity:.25}
hr{border:none;border-top:1px solid #e6e6e6;margin:14px 0}
.smallText{color:#666;font-size:13px}
</style>
</head>

<body>
<header>
  <span class="hamburger" onclick="toggleSidebar()">‚ò∞</span>
  üçî –ú–µ–Ω—é
</header>

<div id="sidebarOverlay" class="sidebarOverlay hidden" onclick="toggleSidebar()"></div>
<div id="sidebar" class="sidebar">
  <h3>üìÇ –†–∞–∑–¥–µ–ª—ã</h3>
  <button class="sbtn" onclick="showOrders(); toggleSidebar()">üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã</button>
  <button class="sbtn" onclick="showReviews(); toggleSidebar()">‚≠ê –û—Ç–∑—ã–≤—ã</button>
  <button class="sbtn" onclick="openReviewForm(); toggleSidebar()">‚úçÔ∏è –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
  <button class="sbtn" onclick="toggleSidebar()">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>

<div id="menu" class="grid"></div>

<div id="cartBtn" class="cart-btn small" onclick="openCart()">üõí –ö–æ—Ä–∑–∏–Ω–∞ (<span id="count">0</span>)</div>
<div id="panel" class="panel hidden"></div>

<script>
const tg = window.Telegram?.WebApp;
if (tg) { tg.ready(); tg.expand(); }

const menuEl = document.getElementById("menu");
const panelEl = document.getElementById("panel");
const cartBtnEl = document.getElementById("cartBtn");

const sidebar = document.getElementById("sidebar");
const sidebarOverlay = document.getElementById("sidebarOverlay");

function toggleSidebar(){
  const isOpen = sidebar.classList.contains("open");
  if (isOpen){
    sidebar.classList.remove("open");
    sidebarOverlay.classList.add("hidden");
  } else {
    sidebar.classList.add("open");
    sidebarOverlay.classList.remove("hidden");
  }
}

/* ---------- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ---------- */
function getUserKey(){
  const tgId = tg?.initDataUnsafe?.user?.id;
  if (tgId) return "tg_" + tgId;

  // –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ —Å—Å—ã–ª–∫—É (GitHub Pages) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π ID
  let anon = localStorage.getItem("anon_user_id");
  if (!anon){
    anon = "anon_" + Math.random().toString(16).slice(2) + Date.now().toString(16);
    localStorage.setItem("anon_user_id", anon);
  }
  return anon;
}
const USER_KEY = getUserKey();

/* ---------- —Ö—Ä–∞–Ω–∏–ª–∏—â–µ ---------- */
function loadJSON(key, fallback){
  try{
    const raw = localStorage.getItem(key);
    return raw ? JSON.parse(raw) : fallback;
  }catch(e){ return fallback; }
}
function saveJSON(key, data){
  localStorage.setItem(key, JSON.stringify(data));
}

function userOrdersKey(){ return `orders_${USER_KEY}`; }
function userReviewKey(){ return `review_${USER_KEY}`; }
function allReviewsKey(){ return `reviews_all`; }

let orders = loadJSON(userOrdersKey(), []);
let myReview = loadJSON(userReviewKey(), null);
let allReviews = loadJSON(allReviewsKey(), []);

/* ---------- —Ç–æ–≤–∞—Ä—ã (–í–ê–®–ò –∫–∞—Ä—Ç–∏–Ω–∫–∏) ---------- */
const foods = [
 {id:1,name:"–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",price:450,img:"https://avatars.mds.yandex.net/i?id=f2e936a65ad15cd289abab0c03c9144540793d54-5481525-images-thumbs&n=13"},
 {id:2,name:"–ü–∏—Ü—Ü–∞ –ü–µ–ø–ø–µ—Ä–æ–Ω–∏",price:520,img:"https://avatars.mds.yandex.net/i?id=7510b4effb790779ad6b3265c75d1c7b35471084-3986751-images-thumbs&n=13"},
 {id:3,name:"–ë—É—Ä–≥–µ—Ä —Å –≥–æ–≤—è–¥–∏–Ω–æ–π",price:390,img:"https://avatars.mds.yandex.net/i?id=c9bbef1504a8d0943fecab07d8e57f0a55f40e00-5257529-images-thumbs&n=13"},
 {id:4,name:"–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å —Ñ—Ä–∏",price:180,img:"https://avatars.mds.yandex.net/i?id=619ea05f2d006710198e7654da95f477da422ad3-4097709-images-thumbs&n=13"},
 {id:5,name:"–°—É—à–∏-—Å–µ—Ç –ú–∏–Ω–∏",price:890,img:"https://avatars.mds.yandex.net/i?id=317733859dd66a7b9d642cbf51b82fc8a74d81e9-4285597-images-thumbs&n=13"},
 {id:6,name:"–†–æ–ª–ª –ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏—è",price:420,img:"https://avatars.mds.yandex.net/i?id=07da68db9d07477d83c2361a6fc7523cea0fb313-4987773-images-thumbs&n=13"},
 {id:7,name:"–°–∞–ª–∞—Ç –¶–µ–∑–∞—Ä—å",price:360,img:"https://avatars.mds.yandex.net/i?id=d5d2672c9ec79214f57d5d7a889f5e8ad6d3562b-5875984-images-thumbs&n=13"},
 {id:8,name:"–ü–∞—Å—Ç–∞ —Å –∫—É—Ä–∏—Ü–µ–π",price:410,img:"https://avatars.mds.yandex.net/i?id=33ecf9434287c2d99114658524cd29b25e6386df-4027955-images-thumbs&n=13"},
 {id:9,name:"–ú–æ—Ä—Å —è–≥–æ–¥–Ω—ã–π",price:120,img:"https://avatars.mds.yandex.net/i?id=802f4b2a1808a2a84aeb9436dd5d8e313aa5a942-5231845-images-thumbs&n=13"},
 {id:10,name:"–ö–æ–ª–∞",price:150,img:"https://avatars.mds.yandex.net/i?id=f8b6d79ad3231eee5ba5b430f44584b18ef64a6d-16971848-images-thumbs&n=13"}
];

/* ---------- –∫–æ—Ä–∑–∏–Ω–∞ ---------- */
let cart = [];

function updateCount(){
  document.getElementById("count").innerText = cart.length;
}
updateCount();

/* ---------- —Ä–µ–Ω–¥–µ—Ä –º–µ–Ω—é ---------- */
function renderMenu(){
  menuEl.innerHTML = "";
  foods.forEach(f=>{
    menuEl.innerHTML += `
      <div class="card">
        <img src="${f.img}" alt="">
        <div class="info">
          <div class="name">${f.name}</div>
          <div class="price">${f.price} ‚ÇΩ</div>
          <button onclick='addToCart(${JSON.stringify(f)})'>‚ûï –í –∫–æ—Ä–∑–∏–Ω—É</button>
        </div>
      </div>
    `;
  });
}
renderMenu();

function addToCart(item){
  cart.push(item);
  updateCount();
}

/* ---------- –ø–∞–Ω–µ–ª—å ---------- */
function openPanel(html){
  panelEl.innerHTML = html;
  panelEl.classList.remove("hidden");
}
function closePanel(){
  panelEl.classList.add("hidden");
}

/* ---------- –∫–æ—Ä–∑–∏–Ω–∞ UI ---------- */
function openCart(){
  let total = 0;
  let html = `<h2>üõí –ö–æ—Ä–∑–∏–Ω–∞</h2>`;

  if (cart.length === 0){
    html += `<p class="smallText">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>`;
  }

  cart.forEach((i,n)=>{
    total += i.price;
    html += `
      <div class="item">
        <div>${i.name}</div>
        <div>
          <b>${i.price} ‚ÇΩ</b>
          &nbsp;&nbsp;<span class="remove" onclick="removeItem(${n})">‚ùå</span>
        </div>
      </div>
    `;
  });

  html += `
    <hr>
    <b>–ò—Ç–æ–≥–æ: ${total} ‚ÇΩ</b>
    <button class="primary-btn" onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
    <button class="secondary-btn" onclick="clearCart()">–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
    <button class="secondary-btn" onclick="closePanel()">–ù–∞–∑–∞–¥</button>
  `;

  openPanel(html);
}

function removeItem(i){
  cart.splice(i,1);
  updateCount();
  openCart();
}
function clearCart(){
  cart = [];
  updateCount();
  openCart();
}

/* ---------- –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ ---------- */
function checkout(){
  if (cart.length === 0){
    openCart();
    return;
  }

  openPanel(`
    <h2>üì¶ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h2>
    <input id="name" placeholder="–ò–º—è">
    <input id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
    <input id="street" placeholder="–£–ª–∏—Ü–∞">
    <input id="house" placeholder="–î–æ–º">
    <select id="pay">
      <option>–ù–∞–ª–∏—á–Ω—ã–µ</option>
      <option>–ö–∞—Ä—Ç–æ–π</option>
    </select>
    <button class="primary-btn" onclick="finishOrder()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
    <button class="secondary-btn" onclick="openCart()">–ù–∞–∑–∞–¥ –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
  `);
}

function finishOrder(){
  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const street = document.getElementById("street").value.trim();
  const house = document.getElementById("house").value.trim();
  const payment = document.getElementById("pay").value;

  if (!name || !phone || !street || !house){
    alert("–ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è üòä");
    return;
  }

  const total = cart.reduce((s,i)=>s+i.price,0);

  const order = {
    id: "ORD-" + Math.random().toString(16).slice(2,8).toUpperCase(),
    created_at: new Date().toLocaleString(),
    status: "–í—ã–ø–æ–ª–Ω–µ–Ω", // –ª–æ–∫–∞–ª—å–Ω–æ —Å—á–∏—Ç–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º (–±–µ–∑ –±—ç–∫–∞)
    name,
    phone,
    address: `${street}, ${house}`,
    payment,
    items: cart,
    total
  };

  orders.unshift(order);
  saveJSON(userOrdersKey(), orders);

  // –æ—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
  cart = [];
  updateCount();

  // —ç–∫—Ä–∞–Ω —Å–ø–∞—Å–∏–±–æ + –∫–Ω–æ–ø–∫–∏
  openPanel(`
    <h2>‚úÖ –°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–∫–∞–∑!</h2>
    <p>–°—Ç–∞—Ç—É—Å: <span class="badge">${order.status}</span></p>
    <p class="smallText">–ù–æ–º–µ—Ä: <b>${order.id}</b><br>–ò—Ç–æ–≥–æ: <b>${order.total} ‚ÇΩ</b></p>
    <button class="primary-btn" onclick="backToMenu()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
    <button class="secondary-btn" onclick="showOrders()">üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã</button>
    <button class="secondary-btn" onclick="maybeAskReview()">‚≠ê –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
  `);

  // –µ—Å–ª–∏ –æ—Ç–∑—ã–≤ –µ—â—ë –Ω–µ –æ—Å—Ç–∞–≤–ª—è–ª–∏ ‚Äî ‚Äú–º—è–≥–∫–æ‚Äù –ø—Ä–µ–¥–ª–æ–∂–∏–º (–Ω–µ –∑–∞—Å—Ç–∞–≤–ª—è–µ–º)
  // (–Ω–æ —Ç—ã —Ö–æ—Ç–µ–ª ‚Äú–∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –æ—Å—Ç–∞–≤–ª—è–ª‚Äù ‚Äî –¥–µ–ª–∞–µ–º —Ç–∞–∫:)
  setTimeout(()=>{ maybeAskReview(true); }, 150);
}

function backToMenu(){
  closePanel();
}

/* ---------- –æ—Ç–∑—ã–≤—ã ---------- */
function maybeAskReview(auto=false){
  if (myReview) {
    if (!auto) openReviewForm(); // –µ—Å–ª–∏ –Ω–∞–∂–∞–ª–∏ –∫–Ω–æ–ø–∫—É ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å
    return;
  }
  // –µ—Å–ª–∏ –∞–≤—Ç–æ-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
  if (auto) openReviewForm();
  else openReviewForm();
}

function openReviewForm(){
  if (myReview){
    openPanel(`
      <h2>‚≠ê –í–∞—à –æ—Ç–∑—ã–≤ —É–∂–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω</h2>
      <p class="smallText">–°–ø–∞—Å–∏–±–æ! –ú–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–∑—ã–≤—ã –≤ –º–µ–Ω—é ‚ò∞</p>
      <button class="primary-btn" onclick="backToMenu()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
      <button class="secondary-btn" onclick="showReviews()">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–∑—ã–≤—ã</button>
    `);
    return;
  }

  let current = 0;

  openPanel(`
    <h2>‚≠ê –û—Å—Ç–∞–≤—å—Ç–µ –æ—Ç–∑—ã–≤</h2>
    <div class="smallText">–ü–æ—Å—Ç–∞–≤—å—Ç–µ –æ—Ü–µ–Ω–∫—É:</div>
    <div id="stars" class="stars"></div>
    <textarea id="reviewText" rows="4" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–∑—ã–≤ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>
    <button class="primary-btn" id="sendReviewBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    <button class="secondary-btn" onclick="backToMenu()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
  `);

  const starsEl = document.getElementById("stars");
  function renderStars(val){
    starsEl.innerHTML = "";
    for (let i=1;i<=5;i++){
      const s = document.createElement("span");
      s.className = "star " + (i<=val ? "" : "off");
      s.textContent = "‚òÖ";
      s.onclick = ()=>{ current = i; renderStars(current); };
      starsEl.appendChild(s);
    }
  }
  renderStars(0);

  document.getElementById("sendReviewBtn").onclick = ()=>{
    if (current < 1){
      alert("–ü–æ—Å—Ç–∞–≤—å –æ—Ç 1 –¥–æ 5 –∑–≤—ë–∑–¥ üòä");
      return;
    }
    const text = document.getElementById("reviewText").value.trim();

    const review = {
      user: USER_KEY,
      stars: current,
      text,
      created_at: new Date().toLocaleString()
    };

    myReview = review;
    allReviews.push(review);

    saveJSON(userReviewKey(), myReview);
    saveJSON(allReviewsKey(), allReviews);

    openPanel(`
      <h2>‚úÖ –°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ç–∑—ã–≤!</h2>
      <p>–û—Ü–µ–Ω–∫–∞: <b>${"‚òÖ".repeat(review.stars)}${"‚òÜ".repeat(5-review.stars)}</b></p>
      ${review.text ? `<p class="smallText">${escapeHtml(review.text)}</p>` : `<p class="smallText">–ë–µ–∑ —Ç–µ–∫—Å—Ç–∞</p>`}
      <button class="primary-btn" onclick="backToMenu()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
      <button class="secondary-btn" onclick="showReviews()">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–∑—ã–≤—ã</button>
    `);
  };
}

function showReviews(){
  allReviews = loadJSON(allReviewsKey(), []);
  if (!allReviews.length){
    openPanel(`
      <h2>‚≠ê –û—Ç–∑—ã–≤—ã</h2>
      <p class="smallText">–ü–æ–∫–∞ –æ—Ç–∑—ã–≤–æ–≤ –Ω–µ—Ç.</p>
      <button class="primary-btn" onclick="backToMenu()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
    `);
    return;
  }

  const avg = (allReviews.reduce((s,r)=>s + (r.stars||0), 0) / allReviews.length).toFixed(1);

  let html = `
    <h2>‚≠ê –û—Ç–∑—ã–≤—ã</h2>
    <p class="smallText">–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞: <b>${avg}</b> ‚Ä¢ –û—Ç–∑—ã–≤–æ–≤: <b>${allReviews.length}</b></p>
    <hr>
  `;

  allReviews.slice().reverse().forEach(r=>{
    html += `
      <div style="background:#fff;border-radius:14px;padding:12px;margin-bottom:10px;box-shadow:0 6px 16px rgba(0,0,0,.08)">
        <div><b>${"‚òÖ".repeat(r.stars)}${"‚òÜ".repeat(5-r.stars)}</b> <span class="smallText">(${r.created_at})</span></div>
        <div class="smallText" style="margin-top:6px">${r.text ? escapeHtml(r.text) : "–ë–µ–∑ —Ç–µ–∫—Å—Ç–∞"}</div>
      </div>
    `;
  });

  html += `
    <button class="primary-btn" onclick="backToMenu()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
  `;
  openPanel(html);
}

/* ---------- –º–æ–∏ –∑–∞–∫–∞–∑—ã ---------- */
function showOrders(){
  orders = loadJSON(userOrdersKey(), []);
  if (!orders.length){
    openPanel(`
      <h2>üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã</h2>
      <p class="smallText">–ü–æ–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–µ—Ç.</p>
      <button class="primary-btn" onclick="backToMenu()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
    `);
    return;
  }

  let html = `<h2>üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã</h2><hr>`;

  orders.forEach((o, idx)=>{
    const itemsList = o.items.map(it=>`‚Ä¢ ${it.name} ‚Äî ${it.price} ‚ÇΩ`).join("<br>");
    html += `
      <div style="background:#fff;border-radius:14px;padding:12px;margin-bottom:12px;box-shadow:0 6px 16px rgba(0,0,0,.08)">
        <div class="smallText">${o.created_at} ‚Ä¢ <b>${o.id}</b></div>
        <div style="margin-top:6px">–°—Ç–∞—Ç—É—Å: <span class="badge">${o.status}</span></div>
        <div class="smallText" style="margin-top:6px">${itemsList}</div>
        <hr>
        <div><b>–ò—Ç–æ–≥–æ: ${o.total} ‚ÇΩ</b></div>
      </div>
    `;
  });

  html += `<button class="primary-btn" onclick="backToMenu()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>`;
  openPanel(html);
}

/* ---------- —É—Ç–∏–ª–∏—Ç—ã ---------- */
function escapeHtml(str){
  return str.replace(/[&<>"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
  }[m]));
}
</script>
</body>
</html>
